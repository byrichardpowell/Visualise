<!DOCTYPE html>
<html>
<head>
	<title>SoundParser</title>
	<script type="text/javascript" src="js/soundparser.js?r=1"></script>
	<style type="text/css">
	#visual {
		border: 1px solid #999;
	}
	</style>
</head>
<body>

<input type="button" value="start()" onclick="MySound.start()"/>
<input type="button" value="stop()" onclick="MySound.stop()"/>

<span>Time: <span id="current-time"></span></span>

<br/><br/>

<canvas id="visual"></canvas>

<br/><br/>

<div id="sound-con"></div>

<script type="text/javascript">
var MySound;
MySound = new SoundParser('music.ogg', 'sound-con');
window.addEventListener('load', function () {
	
	console.log('ready');
	MySound.init();
//		MySound.start();
	
	// Display Lapsed time to make sure audio is referenced properly
	var currentTimeNode = document.querySelector('#current-time');
	MySound.audio.addEventListener('timeupdate', function(e) {
	  var currTime = this.currentTime;
	  currentTimeNode.textContent = parseInt(currTime / 60) + ':' + parseInt(currTime % 60);
	}, false);
	
	// Canvas Reference
	var canvas = document.querySelector('#visual');
	var cx = canvas.getContext('2d');
	canvas.width = 1024;
	canvas.height = 320;
	
	// Simple example
	/*
	var colors = ['#f00', '#0f0', '#00f', '#0ff', '#ff0', '#f0f', '#ccc', '#999', '#000', '#090', '#900', '#009', '#099', '#909'];
	setInterval(function () {
		cx.clearRect(0, 0, canvas.width, canvas.height);
		var d = MySound.getFrequencyData();
		cx.lineWidth = 4;
		for (var i = 0; i < 1024; i += 8) {
			cx.beginPath();
			cx.strokeStyle = colors[Math.round(Math.random() * colors.length)]
			//cx.strokeStyle = Math.max(colors.length - 1, colors[Math.round(d[i] / 30)]);
			cx.moveTo(i, 0);
			cx.lineTo(i, d[i]);
			cx.stroke();
		}
	}, 66);
	*/
	
	// Flying Bird
	MySound.animate({
		name: 'flying-bird',
		func: function () {
			
		},
		fps: 
		width: 1024,
		height: 300,
		canvas: canvas
	});
	
}, false);
</script>

</body>
</html>